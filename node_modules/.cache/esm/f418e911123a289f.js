let User,jwt;_123‍.x([["register",()=>register]]);_123‍.w("../models/user",[["default",["User"],function(v){User=v}]]);_123‍.w("jsonwebtoken",[["default",["jwt"],function(v){jwt=v}]]);// the message/content that will be served when a client
// req the "/:message route. The response is exported to
// the auth.js file in routes

// we are importing the user model we created in models/users.js




       const register = async (req,res)=>{
    
    // the contents the client submited are acced using req.body we will then destracture the contents we will need 
    const {name, email, password} = req.body

    //verifying the contents posted/sent by the client is correct
    if(!name)return res.status(400).send('Name is required')
    if(!password || password.length < 6)
        return res
            .status(400)
            .send("Password is required and should be min 6 chars long")
    let userExist = await User.findOne({email}).exec()
    if(userExist) return res.status(400).send('Email is taken')


    //Once the contents submitted/posted are verified, we will create the account using the user schema
    const user = new User(req.body)

    // Once we created the user, we will save it to the database 
    try {
        await user.save()
        _123‍.g.console.log("User created", user.name)
        return res.json({user})
        
    } catch (error) {
        _123‍.g.console.log("Create User Failed", user)
        return res.status(400).send("Error. Try again")
    }
}
